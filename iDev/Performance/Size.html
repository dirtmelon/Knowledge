<!DOCTYPE HTML>
<html lang="zh-CN" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>åŒ…å¤§å° - Knowledge</title>


        <!-- Custom HTML head -->

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "ayu" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../../About.html">å…³äº</a></li><li class="chapter-item expanded "><a href="../../programming-languages/programming-languages.html">ç¼–ç¨‹è¯­è¨€</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../programming-languages/Swift/Swift.html">Swift</a></li><li class="chapter-item expanded "><a href="../../programming-languages/Objective-C/Objective-C.html">Objective-C</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../programming-languages/Objective-C/Objective-C.html">Runtime</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../programming-languages/Objective-C/associated-objects.html">Associated Objects</a></li><li class="chapter-item expanded "><a href="../../programming-languages/Objective-C/initialize.html">initialize</a></li><li class="chapter-item expanded "><a href="../../programming-languages/Objective-C/load.html">load</a></li><li class="chapter-item expanded "><a href="../../programming-languages/Objective-C/Block.html">Block</a></li><li class="chapter-item expanded "><a href="../../programming-languages/Objective-C/Category.html">Category</a></li><li class="chapter-item expanded "><a href="../../programming-languages/Objective-C/Message-Sending-And-Forwarding.html">Message Sending And Forwarding</a></li><li class="chapter-item expanded "><a href="../../programming-languages/Objective-C/KVO.html">KVO</a></li><li class="chapter-item expanded "><a href="../../programming-languages/Objective-C/KVC.html">KVC</a></li><li class="chapter-item expanded "><a href="../../programming-languages/Objective-C/AutoreleasePool.html">AutoreleasePool</a></li><li class="chapter-item expanded "><a href="../../programming-languages/Objective-C/dealloc.html">dealloc</a></li><li class="chapter-item expanded "><a href="../../programming-languages/Objective-C/Tagged-Pointer.html">Tagged Pointer</a></li><li class="chapter-item expanded "><a href="../../programming-languages/Objective-C/weak.html">weak</a></li><li class="chapter-item expanded "><a href="../../programming-languages/Objective-C/Object.html">Object</a></li><li class="chapter-item expanded "><a href="../../programming-languages/Objective-C/reference-counting.html">Reference Counting</a></li></ol></li><li class="chapter-item expanded "><a href="../../programming-languages/Objective-C/Objective-C.html">Tips</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../programming-languages/Objective-C/getting-subclasses-of-objective-c-class.html">å¦‚ä½•è·å–æŸä¸ªç±»çš„å…¨éƒ¨å­ç±»</a></li><li class="chapter-item expanded "><a href="../../programming-languages/Objective-C/objective-c-class-properties.html">Objective-C ç±»å±æ€§</a></li></ol></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../../iDev/iDev.html">iDev</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../iDev/Multithreading/Introduction.html">å¤šçº¿ç¨‹</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../iDev/Multithreading/NSOperation.html">NSOperation</a></li><li class="chapter-item expanded "><a href="../../iDev/Multithreading/Grand-Central-Dispatch.html">Grand Central Dispatch</a></li><li class="chapter-item expanded "><a href="../../iDev/Multithreading/thread.html">pthread å’Œ NSThread</a></li><li class="chapter-item expanded "><a href="../../iDev/Multithreading/locks.html">Locks</a></li><li class="chapter-item expanded "><a href="../../iDev/Multithreading/RunLoop.html">RunLoop</a></li></ol></li><li class="chapter-item expanded "><a href="../../iDev/UIKit/UIKit.html">UIKit</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../iDev/UIKit/touches_presses_and_gestures.html">ç‚¹å‡»ï¼ŒæŒ‰å‹ä¸æ‰‹åŠ¿</a></li></ol></li><li class="chapter-item expanded "><a href="../../iDev/Architectures/Architectures.html">Architectures</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../iDev/Architectures/MVC.html">MVC</a></li><li class="chapter-item expanded "><a href="../../iDev/Architectures/MVVM.html">MVVM</a></li></ol></li><li class="chapter-item expanded "><a href="../../iDev/Performance/Performance.html">æ€§èƒ½ä¼˜åŒ–</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../iDev/Performance/FPS.html">FPS</a></li><li class="chapter-item expanded "><a href="../../iDev/Performance/Size.html" class="active">åŒ…å¤§å°</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../../books/books.html">é˜…è¯»</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../books/Homo-Deus-A-Brief-History-of-Tomorrow.html">æœªæ¥ç®€å²</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Knowledge</h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/dirtmelon/Knowledge" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="åŒ…å¤§å°"><a class="header" href="#åŒ…å¤§å°">åŒ…å¤§å°</a></h1>
<h2 id="æŠ–éŸ³å“è´¨å»ºè®¾---ios-å®‰è£…åŒ…å¤§å°ä¼˜åŒ–å®è·µç¯‡"><a class="header" href="#æŠ–éŸ³å“è´¨å»ºè®¾---ios-å®‰è£…åŒ…å¤§å°ä¼˜åŒ–å®è·µç¯‡">æŠ–éŸ³å“è´¨å»ºè®¾ - iOS å®‰è£…åŒ…å¤§å°ä¼˜åŒ–å®è·µç¯‡</a></h2>
<p><a href="https://juejin.cn/post/6916317500992913421">æŠ–éŸ³å“è´¨å»ºè®¾ - iOS å®‰è£…åŒ…å¤§å°ä¼˜åŒ–å®è·µç¯‡</a></p>
<p>æ–‡ç« å†…å®¹åŒ…æ‹¬ï¼š</p>
<ul>
<li>AppStore å¯¹å®‰è£…åŒ…çš„é™åˆ¶æ²¿é©ä»¥åŠ App èŠ±è´¹ç²¾åŠ›ä¼˜åŒ– iOS å®‰è£…åŒ…å°†è·å¾—ä»€ä¹ˆæ”¶ç›Šï¼›</li>
<li>å¦‚ä½•å»åˆ†æä¸€ä¸ªå®‰è£…åŒ…ï¼›</li>
<li>å¦‚ä½•åœ¨çº¿ä¸‹å‡†ç¡®æŠŠæ§å®‰è£…åŒ…å¤§å°å¯¹ AppStore ä¸Šå½±å“ï¼›</li>
<li>å¸¸è§çš„ä¸€äº›åŒ…å¤§å°ä¼˜åŒ–æ–¹å¼ï¼›</li>
<li>ä¸€äº›å½±å“åŒ…å¤§å°çš„ç¼–ç ä¹ æƒ¯ã€‚</li>
</ul>
<h3 id="appstore-éƒ¨åˆ†"><a class="header" href="#appstore-éƒ¨åˆ†">AppStore éƒ¨åˆ†</a></h3>
<p>AppStore çš„é™åˆ¶ï¼š</p>
<ul>
<li>2017 å¹´ 9 æœˆï¼Œé™åˆ¶ä» 100MB æå‡åˆ°äº† 150MBï¼›</li>
<li>2019 å¹´ 5 æœˆä¸‹æ—¬ï¼Œè‹¹æœæŠŠ OTA ä¸‹è½½é™åˆ¶æ”¾å®½åˆ° 200MBï¼›</li>
<li>iOS 13 å‘å¸ƒä¹‹å iOS13 åŠä»¥ä¸Šç”¨æˆ·å¯ä»¥ä½¿ç”¨æµé‡ä¸‹è½½è¶…å‡º 200MB çš„ Appï¼Œ ä½†éœ€è¦ç”¨æˆ·ã€Œè®¾ç½®ã€é€‰æ‹©ç­–ç•¥ï¼Œé»˜è®¤ä¸ºã€Œè¶…è¿‡ 200MB è¯·æ±‚è®¸å¯ã€ï¼Œè€Œ iOS13 ä»¥ä¸‹ç”¨æˆ·ä»ç„¶æ— æ³•ä¸‹è½½ã€‚</li>
</ul>
<p>__TEXT æ®µå¤§å°é™åˆ¶ï¼Œå®‰è£…åŒ…å†…æœ€å¤§äºŒè¿›åˆ¶æ‰€æœ‰æ¶æ„çš„æ€»å’Œä¸è¶…è¿‡ 500MBã€‚ï¼ˆåº”è¯¥æ²¡æœ‰è¿˜è¦æ”¯æŒ iOS8 çš„åº”ç”¨äº†å§ï¼‰ã€‚</p>
<blockquote>
<p>é™¤äº† Apple çš„é™åˆ¶å¤–ï¼ŒåŒ…å¤§å°çš„åŠ£åŒ–ä¸€å®šç¨‹åº¦ä¸Šæ„å‘³ç€æ›´åŠ æ…¢çš„å¯åŠ¨é€Ÿåº¦ï¼›æ›´å¤šçš„çš„ä»£ç é€»è¾‘ï¼›æ›´ä½ç ”å‘æ•ˆç‡ï¼›è¿‡äºå¤æ‚çš„ä»£ç è¿˜ä¼šå¸¦æ¥å¯¹ä»£ç ä¿®æ”¹çš„é£é™©å°†å¯¹ç¨³å®šæ€§äº§ç”Ÿè´Ÿé¢å½±å“ï¼›è®©æ€§èƒ½ç­‰åŸºç¡€ä½“éªŒå˜å·®ï¼Œæ‰€ä»¥åŒ…å¤§å°ä¸æ˜¯ä¸€ä¸ªå­¤ç«‹çš„æŒ‡æ ‡ï¼Œå®ƒä»ä¾§é¢åæ˜ å‡º App çš„å¥åº·çŠ¶æ€ã€‚</p>
</blockquote>
<h3 id="å®‰è£…åŒ…åˆ†æ"><a class="header" href="#å®‰è£…åŒ…åˆ†æ">å®‰è£…åŒ…åˆ†æ</a></h3>
<p>å½±å“ä¸‹è½½å’Œå®‰è£…å¤§å°çš„å†…å®¹éƒ½é›†ä¸­åœ¨ .app ä¸­ã€‚è€Œè§£å‹åçš„å ç”¨ .app å¤§éƒ¨åˆ†çš„å¤§å°çš„æ–‡ä»¶å¦‚ä¸‹ï¼š</p>
<ul>
<li>ä¸»äºŒè¿›åˆ¶ï¼ˆå’Œ.app åŒåçš„ MachO æ–‡ä»¶ï¼‰ï¼›</li>
<li>Frameworksï¼ˆApp è‡ªèº«å¼•å…¥çš„åŠ¨æ€åº“ï¼‰ï¼›</li>
<li>Plugins ï¼ˆApp Extension æœ¬è´¨ä¾ç„¶æ˜¯åŠ¨æ€çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼‰ï¼›</li>
<li>xxx.lprojï¼ˆåŸç”Ÿçš„ç¿»è¯‘èµ„æºï¼‰ï¼›</li>
<li>å„ç§èµ„æº Bundleã€‚</li>
</ul>
<p>ä¸Šä¼ åˆ° AppStore Connect åˆ°ä¹‹åï¼ŒApple å¯¹å®‰è£…åŒ…åšäº†ä¸€äº›è°ƒæ•´ï¼š</p>
<ul>
<li>App Slicing å¯¹äºä¸åŒæ¶æ„çš„è£å‰ªï¼Œå¯æ‰§è¡Œæ–‡ä»¶åªå‰©ä¸‹å•æ¶æ„ï¼›</li>
<li>Asset.car ä¸­å›¾ç‰‡åªç•™ä¸‹è®¾å¤‡éœ€è¦çš„ç‰¹å®šå°ºå¯¸å’Œå‹ç¼©ç®—æ³•çš„å˜ä½“ï¼›</li>
<li>äºŒè¿›åˆ¶éƒ¨åˆ† __TEXT æ®µçš„é€šè¿‡ FirePlay è¿›è¡ŒåŠ å¯†å¯¼è‡´ __TEXT æ®µçš„å‹ç¼©æ¯”ä¸º 1ï¼ˆ iOS 13+ ä»¥ä¸Šè®¾å¤‡ä¸‹è½½å˜ä½“ä¸­è‹¹æœç§»é™¤äº†è¿™ä¸ªåŠ å¯† ï¼‰ï¼›</li>
</ul>
<p>LinkMap ä¸­åŒ…å«äº†å¯æ‰§è¡Œæ–‡ä»¶çš„æ¶æ„ä¿¡æ¯ï¼Œæ®µè¡¨ï¼Œé“¾æ¥äº†çš„æ‰€æœ‰æ–‡ä»¶ï¼Œä»¥åŠæ–‡ä»¶ä¸­å„ç¬¦å·å ç”¨çš„å¤§å°ã€‚å…¶å®é€šè¿‡åˆ†æ LinkMap å°±åŸºæœ¬å¾—åˆ°äº†å¯æ‰§è¡Œæ–‡ä»¶ä¸­åŒ…å«äº†å“ªäº›ä¸œè¥¿ã€‚</p>
<h3 id="ä¼˜åŒ–æ‰‹æ®µ"><a class="header" href="#ä¼˜åŒ–æ‰‹æ®µ">ä¼˜åŒ–æ‰‹æ®µ</a></h3>
<p>äºŒè¿›åˆ¶éƒ¨åˆ†çš„ä¼˜åŒ–ï¼š</p>
<ul>
<li>é‡å‘½åéƒ¨åˆ†æ®µç»•è¿‡ __TEXT æ®µ FirePlay åŠ å¯†ï¼›</li>
<li>å¤šä¸ªå¯æ‰§è¡Œæ–‡ä»¶ä¸­å­˜åœ¨å¤šä»½çš„ç›¸åŒä»£ç ï¼Œä¸»è¦æ˜¯ Extension å’Œä¸»äºŒè¿›åˆ¶å…±ç”¨åŒä¸€ä¸ªåº“å¯¼è‡´çš„ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨åŠ¨æ€åº“ï¼Œæˆ–è€…æŠ½ä¸€ä¸ªç²¾ç®€çš„é™æ€åº“ç»™ Extension ä½¿ç”¨ï¼›</li>
<li>æ­»ä»£ç è£å‰ªï¼Œåœ¨æ„å»ºå®Œæˆä¹‹åå¦‚æœæ˜¯ C ã€C++ ç­‰é™æ€çš„è¯­è¨€çš„ä»£ç ã€ä¸€äº›å¸¸é‡å®šä¹‰ï¼Œå¦‚æœå‘ç°æ²¡æœ‰è¢«ä½¿ç”¨åˆ°å°†ä¼šè¢«æ ‡è®°ä¸º Dead codeã€‚å¼€å¯ <code>DEAD_CODE_STRIP = YES</code> è¿™äº› Dead code å°†ä¸ä¼šè¢«æ‰“åŒ…åˆ°å®‰è£…åŒ…ä¸­ï¼›</li>
<li>ç¼–è¯‘æœŸä¼˜åŒ–å‚æ•°ï¼Œ <code>GCC_OPTIMIZATION_LEVEL</code> å®šä¹‰äº† clang ç”¨ä»€ä¹ˆä¼˜åŒ–ç­‰çº§è¿›è¡Œç¼–è¯‘ä¼˜åŒ–ã€‚è¿™é‡Œçš„é…ç½®æ¯”è¾ƒå¤šï¼Œå¯ä»¥çœ‹ä¸‹æ–‡ç« é‡Œçš„ç›¸å…³è¯´æ˜ï¼›</li>
<li>é“¾æ¥æœŸä¼˜åŒ–å‚æ•°ï¼Œ LLVM æä¾›é“¾æ¥æœŸç¼–è¯‘ä¼˜åŒ–ï¼Œé€šè¿‡è®¾ç½®å·¥ç¨‹ä¸­çš„ Link-Time Optimization è¿›è¡Œæ§åˆ¶ã€‚</li>
</ul>
<p>èµ„æºæ–‡ä»¶éƒ¨åˆ†ä¼˜åŒ–ï¼š</p>
<ul>
<li>æ— ç”¨èµ„æºæ‰«æå’Œç§»é™¤ï¼›</li>
<li>èµ„æºåŠ¨æ€åŒ–ï¼Œä¸€èˆ¬éƒ½æ˜¯æ¯”è¾ƒå¤§çš„å›¾ç‰‡ï¼›</li>
<li>On-Demand Resource ï¼›</li>
<li>èµ„æºå‹ç¼©ï¼›</li>
</ul>
<p>æ— ç”¨ä»£ç æ¸…ç†ï¼š</p>
<ul>
<li>é™æ€æ‰«æï¼Œå¯¹äº C/C++ ç­‰é™æ€è¯­è¨€æ¥è¯´ï¼Œç¼–è¯‘å™¨ä¼šå¸®åŠ©æˆ‘ä»¬å°†æ²¡æœ‰ä½¿ç”¨åˆ°çš„ä»£ç æ ‡è®°ä¸º Dead Code ï¼Œæœ€ç»ˆä¸ä¼šæ‰“åˆ°å®‰è£…åŒ…ä¸­ã€‚å¯¹äº Objective-C è¿™ç§åŠ¨æ€è¯­è¨€æ¥è¯´ï¼Œç»“æœåˆ™æ²¡æœ‰è¿™ä¹ˆå‡†ç¡®ï¼›</li>
<li>ä½¿ç”¨ GCOV æˆ–è€… LVVM Profile äºŒè¿›åˆ¶çš„æ’æ¡©ï¼Œä¼šå½±å“åŒ…å¤§å°å’Œæ€§èƒ½ï¼Œæ— æ³•è¿‡å®¡ï¼›</li>
<li>åŸºäº Runtime å®ç°è½»é‡çº§çš„è¿è¡Œæ—¶ç±»è¦†ç›–ç‡æ–¹æ¡ˆï¼Œé€šè¿‡ <code>flags &amp; RW_INITIALIZED</code> å¯ä»¥åˆ¤æ–­ç±»æ˜¯å¦æœ‰åˆå§‹åŒ–ï¼Œé€šè¿‡ä¹Ÿå¯ä»¥æ‰¾åˆ°ä½¿ç”¨ç‡æ¯”è¾ƒå°çš„åœºæ™¯ã€‚</li>
</ul>
<p>ç¼–ç ä¹ æƒ¯å’Œå»ºè®®ï¼š</p>
<ul>
<li>Objective-C Method å’Œ C å‡½æ•°ï¼ŒåŸºäº Objective-C çš„è¿è¡Œæ—¶ï¼Œå¯¹åº”çš„æ–¹æ³•åœ¨ç¼–è¯‘æ—¶ç”Ÿæˆçš„æ•°æ®æ¯” C å‡½æ•°è¦å¤§ï¼Œæ‰€ä»¥å†…éƒ¨åº”è¯¥å°½é‡ä½¿ç”¨ C å‡½æ•°æ¥å®ç°ï¼›</li>
<li>Property vs IVAR ï¼Œ <code>property</code> ä¼šè‡ªåŠ¨ç”Ÿæˆ set å’Œ get æ–¹æ³•ï¼Œå¢åŠ åŒ…å¤§å°ï¼›</li>
<li>å‡å°‘ Block çš„ä½¿ç”¨ï¼Œ Block æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„ Objective-C å¯¹è±¡ï¼Œç¼–è¯‘æ—¶ä¼šç”Ÿæˆæ¯”è¾ƒå¤šçš„ç›¸å…³ä»£ç ï¼›</li>
<li>å‡å°‘å‚æ•°ä¸ªæ•°ï¼›</li>
<li>é«˜é¢‘ç‡ä½¿ç”¨çš„å®ä¸è¦ä½¿ç”¨å¤šè¡Œçš„æ–¹å¼ç¼–å†™ï¼›</li>
<li>é¿å…ä»£ç çš„å¤åˆ¶ç²˜è´´ã€‚</li>
</ul>
<h2 id="objective-c-direct-methods"><a class="header" href="#objective-c-direct-methods">Objective-C Direct Methods</a></h2>
<p><a href="https://pspdfkit.com/blog/2020/objc-type-encodings/">https://pspdfkit.com/blog/2020/objc-type-encodings/</a></p>
<p><a href="https://clang.llvm.org/docs/AttributeReference.html#objc-direct">Clang 13 documentation</a></p>
<p>commit : </p>
<p><a href="https://github.com/llvm/llvm-project/commit/d4e1ba3fa9dfec2613bdcc7db0b58dea490c56b1">Implement <strong>attribute</strong>((objc_direct)), <strong>attribute</strong>((objc_direct_me... Â· llvm/llvm-project@d4e1ba3</a></p>
<p>Clang 13 æ–°å¢äº† <code>objc_direct</code> å£°æ˜ï¼Œå¯¹åº”çš„ Xcode ç‰ˆæœ¬ä¸º 12 ã€‚ä½¿ç”¨ <code>objc_direct</code> æ ‡è®°çš„ Objective-C æ–¹æ³•ä¸ºç›´æ¥æ´¾å‘æ–¹æ³•ã€‚ <code>direct</code> æ–¹æ³•åœ¨è°ƒç”¨æ—¶ç±»ä¼¼äºé™æ€æ–¹æ³•ï¼Œé™ä½äº†ä¸€å®šçš„æ€§èƒ½æŸè€—ï¼Œä½†æ˜¯ä¹Ÿç‰ºç‰²äº† Objective-C çš„ä¸€äº›ç‰¹æ€§ã€‚</p>
<p><code>direct</code> æ–¹æ³•çš„æ¶ˆæ¯å‘é€ä¼šåƒ C å‡½æ•°é‚£æ ·ç›´æ¥è°ƒç”¨å®ç°ï¼Œæ²¡æœ‰èµ° Objective-C çš„æ¶ˆæ¯å‘é€æµç¨‹ã€‚è¿™é‡Œé€Ÿåº¦ä¼šæ¯”è¾ƒå¿«å’Œæœ‰å¯èƒ½è¿›è¡Œå‡½æ•°å†…è”ï¼Œè¿™åŒæ—¶æ„å‘³ç€æ–¹æ³•ä¸èƒ½å¤Ÿè¢«é‡å†™æˆ–è€…åŠ¨æ€æ›¿æ¢ã€‚å› æ­¤ <code>direct</code> æ–¹æ³•ä¸ä¼šå‡ºç°åœ¨ <code>class</code> çš„æ–¹æ³•åˆ—è¡¨ä¸­ï¼Œå¯ä»¥å‡å°‘ä»£ç æ®µçš„å¤§å°ã€‚è™½ç„¶è¯´ <code>direct</code> æ–¹æ³•ä¼šå½“åš C å‡½æ•°æ¥è¿›è¡Œé™æ€è°ƒç”¨ï¼Œä½†æ˜¯å®ƒä»ç„¶éµå¾ªä»¥ä¸‹ Objective-C è¯­ä¹‰ï¼š</p>
<ul>
<li>å¦‚æœæ¥æ”¶è€…ä¸º <code>nil</code> ï¼Œåˆ™ä¸ä¼šè¿›è¡Œä»»ä½•å¤„ç†å’Œè¿”å›æ–¹æ³•è¿”å›å€¼ä¸­å¯¹åº”çš„ <code>zero</code>  å€¼ï¼›</li>
<li>è°ƒç”¨ <code>direct</code> æ–¹æ³•ä¹Ÿä¼šè§¦å‘ <code>class</code> çš„åˆå§‹åŒ–ï¼ŒåŒ…æ‹¬è°ƒç”¨ <code>+initiablize</code> æ–¹æ³•ï¼›</li>
<li>ä¿ç•™æ–¹æ³•é€‰æ‹©å™¨çš„éšå¼å‚æ•° <code>_cmd</code> ï¼Œä½†æ˜¯å¦‚æœ <code>_cmd</code> å‚æ•°æ²¡æœ‰åœ¨æ–¹æ³•ä¸­è¿›è¡Œè°ƒç”¨ï¼Œé‚£ä¹ˆå®ç°ä¸­å°†ä¸ä¼šä¿ç•™å¯¹ <code>_cmd</code> çš„å¼•ç”¨ï¼Œä»¥å‡å°‘ä»£ç æ®µçš„å¤§å°ã€‚</li>
</ul>
<p>åŒæ—¶ä¸æ”¯æŒä»¥ä¸‹æ“ä½œï¼š</p>
<ul>
<li>åœ¨ <code>protocol</code> ä¸­å£°æ˜ <code>direct</code> æ–¹æ³•ï¼›</li>
<li>åœ¨å­ç±»é‡å†™ <code>direct</code> æ–¹æ³•ï¼›</li>
<li>åœ¨å­ç±»ä¸­é‡å†™é <code>direct</code> æ–¹æ³•ï¼ŒåŒæ—¶å®šä¹‰ä¸º <code>direct</code> ï¼›</li>
<li>ç›¸åŒçš„æ–¹æ³•åœ¨ä¸åŒçš„ç±»æ¥å£ä¸­å¯¹ <code>direct</code> çš„å£°æ˜ä¸ä¸€è‡´ï¼›</li>
<li>åœ¨ <code>interface</code> å’Œ <code>implement</code> ä¸­å¯¹ <code>direct</code> çš„å£°æ˜ä¸ä¸€è‡´ï¼›</li>
<li>ä¸å¯ä»¥é€šè¿‡ <code>@selector</code> å’Œæ–¹æ³•åæ¥è·å– <code>direct</code> æ–¹æ³•çš„ <code>SEL</code> ã€‚</li>
</ul>
<p><code>class</code> çš„ <code>interface</code> åŒ…æ‹¬äº† <code>class</code> çš„ <code>@interface</code> block ï¼Œextensions ï¼Œ categories ï¼Œprotocol å’Œçˆ¶ç±»çš„ <code>interface</code> ã€‚</p>
<p>Objective-C å±æ€§ä¹Ÿæ”¯æŒå£°æ˜ä¸º <code>direct</code> å±æ€§ï¼Œåœ¨æ²¡æœ‰æ˜¾ç¤ºå£°æ˜ <code>getter</code> å’Œ <code>setter</code> çš„å‰æä¸‹ï¼Œä¼šé»˜è®¤å£°æ˜ä¸º <code>direct</code> ã€‚</p>
<p>å¦‚æœéœ€è¦æ‰¹é‡å£°æ˜ï¼Œå¯ä»¥ä½¿ç”¨ <code>objc_direct_members</code> å£°æ˜ã€‚å¯ä»¥åœ¨ <code>@interface</code> æˆ–è€… <code>@implementation</code> ä¸­è¿›è¡Œå£°æ˜ï¼Œå¯¹åº”çš„ <code>.m</code> ä¸­çš„æ–¹æ³•éƒ½ä¼šè¢«è®¾ä¸º <code>direct</code> ã€‚å½“  <code>objc_direct_members</code> æ”¾ç½®åœ¨ <code>@interface</code> æ—¶ï¼Œåªæœ‰å‡ºç°åœ¨ <code>@interface</code> çš„æ–¹æ³•ä¼šè®¾ç½®ä¸º <code>direct</code> ï¼Œè¿™åŒ…æ‹¬äº†å±æ€§çš„éšå¼æ–¹æ³•å£°æ˜ã€‚</p>
<p>å¦‚æœåœ¨ <code>@implementation</code> ä¸­è¿›è¡Œå£°æ˜ï¼Œé™¤äº†å·²åœ¨å…¶å®ƒ <code>@interface</code> å£°æ˜ä¸º <code>non-direct</code> çš„æ–¹æ³•ï¼Œå…¶å®ƒæ–¹æ³•éƒ½ä¼šå£°æ˜ä¸º <code>direct</code> ã€‚</p>
<p>å¦‚æœæ²¡åŠæ³•ä¿è¯å¤–éƒ¨è°ƒç”¨ä¼šå¦‚ä½•å¤„ç†æ–¹æ³•ï¼Œé‚£ä¹ˆæ¯”è¾ƒä¿å®ˆçš„ç­–ç•¥å°±æ˜¯åªå¤„ç† <code>.m</code> é‡Œçš„ç§æœ‰æ–¹æ³•å’Œå±æ€§ã€‚</p>
<p><a href="https://twitter.com/pedantcoder/status/1197269246289444864">Pierre H. ğŸ”¥ğŸŒ¸ on Twitter: &quot;About objc_direct, a thread.I should have probably anticipated that people would raise eyebrows and spent more time explaining the point in the LLVM commit, so here it is... https://t.co/zgnaKD6n4A / Twitter&quot;</a></p>
<p>è¿™æ¡æ¨ä¸‹é¢è¯¦ç»†è¯´æ˜äº† Objective-C æ¶ˆæ¯å‘é€æœºåˆ¶å¸¦æ¥çš„æŸè€—ï¼Œä¸»è¦åŒ…æ‹¬ä»¥ä¸‹å››æ–¹é¢ï¼š</p>
<ul>
<li>ä»£ç æ®µå¤§å°ï¼Œç”±äºéœ€è¦æŸ¥æ‰¾æ–¹æ³•æŒ‡é’ˆ <code>IMP</code> ï¼Œæ‰€ä»¥éœ€è¦ä¼ é€’ <code>sekf</code> å’Œ <code>_cmd</code> å‚æ•°ã€‚æ¯æ¬¡è°ƒç”¨ä¼šå¸¦æ¥é¢å¤– 8 å­—èŠ‚çš„æ¶ˆè€—ï¼Œç”±äº <code>objc_msgSend</code> çš„è°ƒç”¨éå¸¸é¢‘ç¹ï¼Œæ‰€ä»¥ 8 å­—èŠ‚å åŠ åå æ¯”éå¸¸å¤§ã€‚åœ¨ CloudKit ä¸­ï¼Œè¿™ä¸¤ä¸ªæŒ‡ä»¤å äº† <code>__text</code> æ®µ 10.7% çš„å¤§å°ï¼›</li>
<li>ä¼˜åŒ–é˜»ç¢ï¼Œä¸ºäº†æ›´å¼ºçš„åŠ¨æ€æ€§å’Œ ARC ç­‰ç‰¹æ€§ï¼Œ Objective-C è¦æ±‚ç¼–è¯‘å™¨åšå‡ºå·¨å¤§çš„ä¿æŠ¤æ€§ç¼–ç¨‹ã€‚æ‹’ç»å†…è”æ˜¯æ¯”è¾ƒæ˜æ˜¾çš„ä¸€ä¸ªé—®é¢˜ï¼Œè¿˜æœ‰çš„æ˜¯åœ¨è·å–å¯è¯»çš„ <code>integer</code> å±æ€§æ—¶ä¹Ÿä¼šå¸¦æ¥å½±å“ï¼ŒARC ä¼šæ’å…¥ <code>objc_retain()/objc_releas()</code> æ–¹æ³•åŒ…å›´å±æ€§çš„ <code>getter</code> æ–¹æ³•ï¼›</li>
<li>é™æ€å…ƒæ•°æ®ï¼Œæ¯ä¸ª Objective-C çš„æ–¹æ³•éƒ½ä¼šå¢åŠ  150-250 å­—èŠ‚å¤§å°ã€‚
<ul>
<li>ç±»çš„æ–¹æ³•åˆ—è¡¨ä¸­ä¼šå¢åŠ  24 å­—èŠ‚ï¼›</li>
<li>æ–¹æ³•çš„ <code>type</code> å­—ç¬¦ä¸²è¶…è¿‡ 60 å­—èŠ‚ï¼Œå¦‚æœä¸ä½¿ç”¨ <code>NSInvocation</code> åˆ™æ²¡æœ‰ä¸éœ€è¦è¯¥å­—ç¬¦ä¸²ï¼›</li>
<li>æ–¹æ³•çš„é€‰æ‹©å™¨å¹³å‡ä¸º 20+ å­—èŠ‚ã€‚</li>
</ul>
</li>
<li>è¿è¡Œæ—¶å…ƒæ•°æ®ï¼Œä¸ºäº†åŠ å¿«æ¶ˆæ¯å‘é€çš„é€Ÿåº¦ï¼Œè¿è¡Œæ—¶ä¼šåˆ›å»º <code>IMP</code> ç¼“å­˜ï¼Œå³ä½¿æ˜¯ä¸€äº›åªè°ƒç”¨ä¸€æ¬¡çš„æ–¹æ³•ï¼Œä¹Ÿä¼šå¸¦è¿›ç¨‹å¸¦æ¥è´Ÿæ‹…ï¼ŒåŒæ—¶ç”±äºè¿è¡Œæ—¶åˆå§‹åŒ–æ—¶éœ€è¦é‡å®šä½æŒ‡é’ˆï¼Œä¹Ÿä¼šå¯¹å¯åŠ¨æ€§èƒ½å¸¦æ¥å½±å“ã€‚</li>
</ul>
<p><a href="https://nshipster.com/direct/">Objective-C Direct Methods</a></p>
<p>å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œ <code>direct</code> æ–¹æ³•å…¶å®ä¸ä¼šå¸¦æ¥æ˜æ˜¾çš„æ€§èƒ½æ”¶ç›Šï¼Œ <code>objc_msgSend</code> çš„å¤„ç†é€Ÿåº¦å…¶å®éå¸¸å¿«ï¼Œè¿™å¾—ç›Šäºæå…¶ä¾µç•¥çš„ç¼“å­˜ç­–ç•¥ï¼Œå¹¿æ³›çš„åº•å±‚ä¼˜åŒ–ä»¥åŠç°ä»£å¤„ç†å™¨çš„è¿›æ­¥ã€‚åœ¨å­˜é‡ä»£ç æ¯”è¾ƒå¤šçš„æƒ…å†µä¸‹ï¼ŒæŠŠæ–¹æ³•æ”¹å†™ä¸º <code>direct</code> ä¼šå‡å°‘ä¸€å®šçš„ä»£ç æ®µå¤§å°ã€‚</p>
<p><a href="https://pspdfkit.com/blog/2020/improving-performance-via-objc-direct/">Direct Calls with Objective-C | PSPDFKit</a></p>
<p>æ€§èƒ½ç›¸å…³æ•°æ®ï¼š</p>
<p>PSPDFKit æ›¿æ¢äº† 3717 ä¸ªæ–¹æ³•ï¼Œå‡å°‘äº† 700 KB ï¼Œå¹³å‡æ¯ä¸ªæ–¹æ³•å‡å°‘äº† 200 å­—èŠ‚ã€‚</p>
<h2 id="é¿å…-objective-c-type-encoding-è¿‡å¤§"><a class="header" href="#é¿å…-objective-c-type-encoding-è¿‡å¤§">é¿å… Objective-C Type Encoding è¿‡å¤§</a></h2>
<p><a href="https://pspdfkit.com/blog/2020/objc-type-encodings/">Preventing Surprisingly Large Objective-C Type Encodings | PSPDFKit</a></p>
<p>åœ¨è¿›è¡Œ Objective-C å’Œ C++ æ··ç¼–æ—¶ï¼Œç±»å‹ç¼–ç ï¼ˆ Type Encodings ï¼‰ä¼šå˜æˆå‡ åƒä¸ªå­—ç¬¦ï¼Œä¼šå½±å“åŒ…å¤§å°å’Œæ€§èƒ½ã€‚</p>
<h3 id="type-encodings"><a class="header" href="#type-encodings">Type Encodings</a></h3>
<p>Objective-C çš„ <code>selector</code> åªä¼šåŒ…å«åå­—å’Œå‚æ•°ä¸ªæ•°ï¼Œæ¯ä¸ªå‚æ•°çš„ç±»å‹åˆ™ä¼šä¿å­˜åœ¨æ–¹æ³•çš„ Type Encodings ä¸­ï¼Œç¼–ç ä¸ºä¸€ä¸ªç®€å•çš„å­—ç¬¦ä¸²ã€‚å¦‚æœå¸¦æœ‰ C++ ç±»å‹ï¼Œå­—ç¬¦ä¸²ä¼šå˜å¾—å¾ˆé•¿å’Œå¢åŠ äºŒè¿›åˆ¶åŒ…å¤§å°ã€‚ <code>NSMethodSignature</code> ç”¨äºå¸®åŠ©è§£æå‚æ•°å­—ç¬¦ä¸²ã€‚æ¯”å¦‚è¯´ <code>CGRect</code> ï¼Œå¯¹åº”çš„ Type Encoding å­—ç¬¦ä¸²ä¸ºï¼š <code>{CGRect={CGPoint=dd}{CGSize=dd}}16@0:8</code> ã€‚</p>
<p>å¯¹åº” C++ ç±»å‹æ¥è¯´å°±æ¯”è¾ƒæƒŠå–œäº†ï¼Œæ¯”å¦‚è¯´ <code>std::unordered_map&lt;PSPDFAnnotationPlaceholderState, NSString *&gt;</code> ï¼Œè½¬æ¢ä¸ºå­—ç¬¦ä¸²ä¹‹åè¶…è¿‡ 3000 ä¸ªå­—ç¬¦ä¸²ï¼š</p>
<pre><code class="language-cpp">PSPDFAnnotationPlaceholder._actionsForStates: (3176) {unordered_map&lt;PSPDFAnnotationPlaceholderState
  , NSString *, std::__1::hash&lt;PSPDFAnnotationPlaceholderState&gt;, std::__1::equal_to&lt;PSPDFAnnotationPlaceholderState&gt;,
  std::__1::allocator&lt;std::__1::pair&lt;const PSPDFAnnotationPlaceholderState, NSString *&gt; &gt; &gt;=&quot;__table_&quot;{__hash_table
    &lt;std::__1::__hash_value_type&lt;PSPDFAnnotationPlaceholderState, NSString *&gt;, std::__1::__unordered_map_hasher
    &lt;PSPDFAnnotationPlaceholderState, std::__1::__hash_value_type&lt;PSPDFAnnotationPlaceholderState, NSString *&gt;,
    std::__1::hash&lt;PSPDFAnnotationPlaceholderState&gt;, true&gt;, std::__1::__unordered_map_equal&lt;PSPDFAnnotationPlaceholderState, std::__1::__hash_value_type&lt;PSPDFAnnotationPlaceholderState, NSString *&gt;, std::__1::equal_to&lt;PSPDFAnnotationPlaceholderState&gt;, true&gt;, std::__1::allocator&lt;std::__1::__hash_value_type&lt;PSPDFAnnotationPlaceholderState, NSString *&gt; &gt; &gt;=&quot;__bucket_list_&quot;{unique_ptr&lt;std::__1::__hash_node_base&lt;std::__1::__hash_node&lt;std::__1::__hash_value_type&lt;PSPDFAnnotationPlaceholderState, NSString *&gt;, void *&gt; *&gt; *[], std::__1::__bucket_list_deallocator&lt;std::__1::allocator&lt;std::__1::__hash_node_base&lt;std::__1::__hash_node&lt;std::__1::__hash_value_type&lt;PSPDFAnnotationPlaceholderState, NSString *&gt;, void *&gt; *&gt; *&gt; &gt; &gt;=&quot;__ptr_&quot;{__compressed_pair&lt;std::__1::__hash_node_base&lt;std::__1::__hash_node&lt;std::__1::__hash_value_type&lt;PSPDFAnnotationPlaceholderState, NSString *&gt;, void *&gt; *&gt; **, std::__1::__bucket_list_deallocator&lt;std::__1::allocator&lt;std::__1::__hash_node_base&lt;std::__1::__hash_node&lt;std::__1::__hash_value_type&lt;PSPDFAnnotationPlaceholderState, NSString *&gt;, void *&gt; *&gt; *&gt; &gt; &gt;=&quot;__value_&quot;^^{__hash_node_base&lt;std::__1::__hash_node&lt;std::__1::__hash_value_type&lt;PSPDFAnnotationPlaceholderState, NSString *&gt;, void *&gt; *&gt;}&quot;__value_&quot;{__bucket_list_deallocator&lt;std::__1::allocator&lt;std::__1::__hash_node_base&lt;std::__1::__hash_node&lt;std::__1::__hash_value_type&lt;PSPDFAnnotationPlaceholderState, NSString *&gt;, void *&gt; *&gt; *&gt; &gt;=&quot;__data_&quot;{__compressed_pair&lt;unsigned long, std::__1::allocator&lt;std::__1::__hash_node_base&lt;std::__1::__hash_node&lt;std::__1::__hash_value_type&lt;PSPDFAnnotationPlaceholderState, NSString *&gt;, void *&gt; *&gt; *&gt; &gt;=&quot;__value_&quot;Q}}}}&quot;__p1_&quot;{__compressed_pair&lt;std::__1::__hash_node_base&lt;std::__1::__hash_node&lt;std::__1::__hash_value_type&lt;PSPDFAnnotationPlaceholderState, NSString *&gt;, void *&gt; *&gt;, std::__1::allocator&lt;std::__1::__hash_node&lt;std::__1::__hash_value_type&lt;PSPDFAnnotationPlaceholderState, NSString *&gt;, void *&gt; &gt; &gt;=&quot;__value_&quot;{__hash_node_base&lt;std::__1::__hash_node&lt;std::__1::__hash_value_type&lt;PSPDFAnnotationPlaceholderState, NSString *&gt;, void *&gt; *&gt;=&quot;__next_&quot;^{__hash_node_base&lt;std::__1::__hash_node&lt;std::__1::__hash_value_type&lt;PSPDFAnnotationPlaceholderState, NSString *&gt;, void *&gt; *&gt;}}}&quot;__p2_&quot;{__compressed_pair&lt;unsigned long, std::__1::__unordered_map_hasher&lt;PSPDFAnnotationPlaceholderState, std::__1::__hash_value_type&lt;PSPDFAnnotationPlaceholderState, NSString *&gt;, std::__1::hash&lt;PSPDFAnnotationPlaceholderState&gt;, true&gt; &gt;=&quot;__value_&quot;Q}&quot;__p3_&quot;{__compressed_pair&lt;float, std::__1::__unordered_map_equal&lt;PSPDFAnnotationPlaceholderState, std::__1::__hash_value_type&lt;PSPDFAnnotationPlaceholderState, NSString *&gt;, std::__1::equal_to&lt;PSPDFAnnotationPlaceholderState&gt;, true&gt; &gt;=&quot;__value_&quot;f}}}
</code></pre>
<h3 id="æ‰«æäºŒè¿›åˆ¶ä¸­å¯¹åº”çš„å­—ç¬¦ä¸²å¤§å°"><a class="header" href="#æ‰«æäºŒè¿›åˆ¶ä¸­å¯¹åº”çš„å­—ç¬¦ä¸²å¤§å°">æ‰«æäºŒè¿›åˆ¶ä¸­å¯¹åº”çš„å­—ç¬¦ä¸²å¤§å°</a></h3>
<p>ä½¿ç”¨ <code>strings [Foo.app.Foo](http://Foo.app.Foo) | grep -e '{'</code> æ‰«æäºŒè¿›åˆ¶åŒ…å¯ä»¥æ‰¾åˆ°å¯¹åº”çš„ Type Encoding å­—ç¬¦ä¸²ã€‚ä½œè€…å†™äº†ä¸ª Swift å·¥å…·ï¼Œå¯ä»¥å¿«é€ŸæŸ¥æ‰¾é¡¹ç›®ä¸­ Type Encoding å­—ç¬¦ä¸²æ¯”è¾ƒå¤§çš„æ–¹æ³•ï¼š</p>
<p><a href="https://gist.github.com/steipete/2d50571f0fd4963ebe9b0062fec0976f">Runtime Scanner to find large ObjC encodings. Inspired by https://medium.com/@dmaclach/objective-c-encoding-and-you-866624cc02de - this code scans the runtime to find excessive Objective-C type encodings, usually created when you mix it with C++. We were able to reduce the binary size by 100KB with rewriting just a few methods that were extremely large.</a></p>
<h3 id="å¦‚ä½•è°ƒæ•´"><a class="header" href="#å¦‚ä½•è°ƒæ•´">å¦‚ä½•è°ƒæ•´</a></h3>
<p>æœ‰å¾ˆå¤šç§æ–¹æ³•éšè— C++ å¯¹è±¡ï¼Œä½œè€…é€šå¸¸åˆ›å»ºä¸€ä¸ªå•ç‹¬çš„ <code>struct</code> åŒ…å«æ‰€æœ‰ C++ å¯¹è±¡ï¼Œç„¶åæŠŠè¿™ä¸ª <code>struct</code> æ”¾åˆ° Objective-C å¯¹åº”çš„ç±»ä¸­ï¼Œä½¿ç”¨ <code>std::unique_ptr</code> æ¥è¿›è¡Œå£°æ˜ã€‚</p>
<p><img src="media/16368247507666.jpg" alt="" /></p>
<h3 id="ç»“æœ"><a class="header" href="#ç»“æœ">ç»“æœ</a></h3>
<p>ä½œè€…ä½¿ç”¨ <a href="https://github.com/google/bloaty">https://github.com/google/bloaty</a> æ¥è¿›è¡Œæµ‹é‡ï¼Œæœ€åå‘ç°å¤§æ¦‚å‡å°‘äº† 100KB ï¼Œå³äºŒè¿›åˆ¶æ–‡ä»¶çš„ 0.5% ï¼Œè™½ç„¶ä¸æ˜¯å¾ˆå¤šï¼Œä½†æ˜¯ä½œè€…åªèŠ±äº†ä¸€å¤©ï¼Œæœ‰å…´è¶£çš„ä¹Ÿå¯ä»¥è‡ªå·±è¯•ä¸€ä¸‹ã€‚</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../iDev/Performance/FPS.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="../../books/books.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../iDev/Performance/FPS.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../../books/books.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script type="text/javascript">
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../searcher.js" type="text/javascript" charset="utf-8"></script>

        <script src="../../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->


    </body>
</html>
